
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JWST Calibration Pipeline Build 7.6 for MIRI Team &#8212; JWST Pipeline Build 7.6 tutorials</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ramps-to-slopes: Detector1Pipeline (MIRI CALDETECTOR1)" href="Level1_Detector1Pipeline.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/MIRI_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">JWST Pipeline Build 7.6 tutorials</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="#">
   JWST Calibration Pipeline Build 7.6 for MIRI Team
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Level1_Detector1Pipeline.html">
   Ramps-to-slopes:  Detector1Pipeline   (MIRI CALDETECTOR1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dq_init.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     dq_init
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="saturation.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     saturation
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="firstframe.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     firstframe
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lastframe.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     lastframe
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linearity.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     linearity
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="RSCD.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     rscd
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dark_current.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     dark_current
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="refpix.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     refpix
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jump.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     jump
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ramp_fitting.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     ramp_fitting
    </span>
   </code>
   step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Level2_Image2Pipeline.html">
   Image2Pipeline   (MIRI CALIMAGE2)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Level3_Image3Pipeline.html">
   Image3Pipeline   (MIRI CALIMAGE3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Level2_Spec2Pipeline_MRS.html">
   Spec2Pipeline for MRS   (MIRI MRS CALSPEC2)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Level3_Spec3Pipeline_MRS.html">
   Spec3Pipeline for MRS   (MIRI MRS CALSPEC3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Level2_Spec2Pipeline_LRS-SLIT_point_source.html">
   Spec2Pipeline for LRS-SLIT   (MIRI LRS-SLIT CALSPEC2) for point source
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/Introduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/content/Introduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pipeline-stages">
     Pipeline stages
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additional-packages">
     Additional packages
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calibration-reference-data-system-crds">
   Calibration Reference Data System (CRDS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crds-configuration">
     CRDS configuration
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pipeline-output">
   Pipeline output
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-jwst-pipeline">
   Running the JWST pipeline
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="jwst-calibration-pipeline-build-7-6-for-miri-team">
<h1>JWST Calibration Pipeline Build 7.6 for MIRI Team<a class="headerlink" href="#jwst-calibration-pipeline-build-7-6-for-miri-team" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This Jupyter book provides instructions on running the JWST Calibration Pipeline and individual pipeline steps. Information in this book is collated from the official JWST Calibration Pipeline documentation (see link below), MIRI CDP documentation, MIRI Team Wiki, etc. The goal is to provide information, user instructions, examples and issues for each pipeline and steps (except coronography). More detailed information on the pipeline can be found here:</p>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/">https://jwst-pipeline.readthedocs.io/en/latest/</a></p>
<p>If you have or find any other issues installing and running the pipeline you can report them on the MIRI JIRA system.</p>
<div class="section" id="pipeline-stages">
<h3>Pipeline stages<a class="headerlink" href="#pipeline-stages" title="Permalink to this headline">¶</a></h3>
<p>There are three different stages of processing for the JWST observing modes:</p>
<ul class="simple">
<li><p>Stage 1: Detector-level corrections and ramp fitting for individual exposures</p></li>
<li><p>Stage 2: Instrument-mode calibrations for individual exposures</p></li>
<li><p>Stage 3: Combining data from multiple exposures within an observation</p></li>
</ul>
<p>Stage 1 corrections are applied nearly universally for all instruments and modes. Stage 2 is divided into separate modules for imaging and spectroscopic modes. Stage 3 is divided into five separate modules for imaging, spectroscopic, coronagraphic, Aperture Masking Interferometry (AMI), and Time Series Observation (TSO) modes.</p>
<p>This book is split into chapters according to these stages and application to relevant MIRI modes.</p>
</div>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This book is specifically for Build 7.6 of the JWST Calibration Pipeline. To install this version you must have an Anaconda installation:</p>
<p><a class="reference external" href="https://www.anaconda.com/">https://www.anaconda.com/</a></p>
<p>To install, open a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create -n jwst_env --file &lt;URL&gt;
conda activate jwst_env
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;URL&gt;</span></code> is dependent on the operating system:</p>
<p>Linux: <a class="reference external" href="https://ssb.stsci.edu/releases/jwstdp/0.17.1/conda_python_stable-deps.txt">https://ssb.stsci.edu/releases/jwstdp/0.17.1/conda_python_stable-deps.txt</a></p>
<p>OS X: <a class="reference external" href="https://ssb.stsci.edu/releases/jwstdp/0.17.1/conda_python_macos-stable-deps.txt">https://ssb.stsci.edu/releases/jwstdp/0.17.1/conda_python_macos-stable-deps.txt</a></p>
<p>Then install the dependencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r &lt;URL&gt;
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;URL&gt;</span></code> is again dependent on the operating system:</p>
<p>Linux: <a class="reference external" href="https://ssb.stsci.edu/releases/jwstdp/0.17.1/reqs_stable-deps.txt">https://ssb.stsci.edu/releases/jwstdp/0.17.1/reqs_stable-deps.txt</a></p>
<p>OS X: <a class="reference external" href="https://ssb.stsci.edu/releases/jwstdp/0.17.1/reqs_macos-stable-deps.txt">https://ssb.stsci.edu/releases/jwstdp/0.17.1/reqs_macos-stable-deps.txt</a></p>
<div class="section" id="additional-packages">
<h3>Additional packages<a class="headerlink" href="#additional-packages" title="Permalink to this headline">¶</a></h3>
<p>The resulting pipeline envirnoment will not contain packages often used for testing and development. Two of the most commonly used are <code class="docutils literal notranslate"><span class="pre">jupyter</span></code> and <code class="docutils literal notranslate"><span class="pre">ipython</span></code>. To install these:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install jupyter ipython -y
</pre></div>
</div>
</div>
</div>
<div class="section" id="calibration-reference-data-system-crds">
<h2>Calibration Reference Data System (CRDS)<a class="headerlink" href="#calibration-reference-data-system-crds" title="Permalink to this headline">¶</a></h2>
<p>The CRDS is the calibration file server for the JWST Calibration Pipeline. When running the pipeline, the calibration steps will use the <code class="docutils literal notranslate"><span class="pre">crds</span></code> task to fetch appropriate files from the CRDS and store them locally. Therefore, it is important that you have this setup correctly.</p>
<div class="section" id="crds-configuration">
<h3>CRDS configuration<a class="headerlink" href="#crds-configuration" title="Permalink to this headline">¶</a></h3>
<p>To use the CRDS server, one must set the <code class="docutils literal notranslate"><span class="pre">CRDS_PATH</span></code> and <code class="docutils literal notranslate"><span class="pre">CRDS_SERVER_URL</span></code> environment variables which tell the <code class="docutils literal notranslate"><span class="pre">crds</span></code> task where to find and store the calibration files. Set these (e.g., in your bash login file):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CRDS_PATH</span><span class="o">=</span>/path/to/your/crds
<span class="nb">export</span> <span class="nv">CRDS_SERVER_URL</span><span class="o">=</span><span class="s2">&quot;https://jwst-crds.stsci.edu&quot;</span>
</pre></div>
</div>
<p>The reference file mapping is set using the <code class="docutils literal notranslate"><span class="pre">CRDS_CONTEXT</span></code> environment variable. For Build 7.3, this should be set to 535 and will contain the CRDS-ingested MIRI CDP7 files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CRDS_CONTEXT</span><span class="o">=</span><span class="s1">&#39;jwst_0641.pmap&#39;</span>
</pre></div>
</div>
<p>Note that the calibration files can be large (~GB) and may take some time to download. However, the <code class="docutils literal notranslate"><span class="pre">crds</span></code> task will only fetch calibration files from the server if they are not on your system so they will only be downloaded once. Using the CRDS server will require the least amount of CRDS file storage on your system.</p>
</div>
</div>
<div class="section" id="pipeline-output">
<h2>Pipeline output<a class="headerlink" href="#pipeline-output" title="Permalink to this headline">¶</a></h2>
<p>Unless the user specifies an output filename, the various pipeline modules will use the input root along with a set of predetermined suffixes to set the outputs. The output suffix will always replace the input suffix. The list of default suffixes is:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Product</p></th>
<th class="text-align:left head"><p>Suffix</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>uncalibrated level 1B</p></td>
<td class="text-align:left"><p>uncal</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>level 2A ramp</p></td>
<td class="text-align:left"><p>ramp</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>level 2A count rate image</p></td>
<td class="text-align:left"><p>rate</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>level 2A count rate per integration</p></td>
<td class="text-align:left"><p>rateints</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>optional fitting results from ramp_fit step</p></td>
<td class="text-align:left"><p>fitopt</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>level 2B background-subtracted image</p></td>
<td class="text-align:left"><p>bsub</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>level 2B background-subtracted image per integration</p></td>
<td class="text-align:left"><p>bsubints</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>fully calibrated level 2B image</p></td>
<td class="text-align:left"><p>cal</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>fully calibrated level 2B images per integration</p></td>
<td class="text-align:left"><p>calints</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1D extracted spectrum</p></td>
<td class="text-align:left"><p>x1d</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>1D extracted spectra per integration</p></td>
<td class="text-align:left"><p>x1dints</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Resampled image</p></td>
<td class="text-align:left"><p>i2d</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Resampled spectrum</p></td>
<td class="text-align:left"><p>s2d</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Resampled 3D IFU cube</p></td>
<td class="text-align:left"><p>s3d</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="running-the-jwst-pipeline">
<h2>Running the JWST pipeline<a class="headerlink" href="#running-the-jwst-pipeline" title="Permalink to this headline">¶</a></h2>
<p>The JWST pipeline can be run either from the command line or from within python. The examples in this book will demonstrate both options.</p>
<p>The instructions and tutorials for the pipelines by following the links on the left.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='right-next' id="next-link" href="Level1_Detector1Pipeline.html" title="next page">Ramps-to-slopes:  Detector1Pipeline   (MIRI CALDETECTOR1)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Patrick Kavanagh<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>